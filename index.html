<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Salon Chair System</title>

<style>
body{
  font-family: system-ui, Segoe UI, Roboto;
  background:#f2f4f8;
  padding:14px;
}
h2{text-align:center;margin-bottom:12px}

.card{
  background:#fff;
  padding:16px;
  border-radius:14px;
  margin-bottom:14px;
  box-shadow:0 6px 18px rgba(0,0,0,.08);
}

button{
  padding:16px;
  font-size:17px;
  border-radius:12px;
  border:none;
  cursor:pointer;
}

/* ===== CHAIRS (FULL WIDTH) ===== */
.chair{
  width:100%;
  margin-bottom:8px;
  background:#2563eb;
  color:#fff;
}
.chair.active{background:#16a34a}

/* ===== SERVICES ===== */
.services{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
}
.service{
  background:#e5e7eb;
}
.service.active{
  background:#22c55e;
  color:#fff;
}

/* ===== ACTION BUTTONS ===== */
.save{background:#16a34a;color:#fff;width:100%}
.download{background:#15803d;color:#fff;width:100%}
.reset{background:#dc2626;color:#fff;width:100%}

.total{
  font-size:22px;
  font-weight:bold;
  text-align:center;
}

table{
  width:100%;
  border-collapse:collapse;
  font-size:14px;
}
th,td{
  border-bottom:1px solid #ddd;
  padding:8px;
}

/* ===== TOAST ===== */
#toast{
  position:fixed;
  bottom:25px;
  left:50%;
  transform:translateX(-50%);
  background:#111827;
  color:#fff;
  padding:14px 18px;
  border-radius:12px;
  display:none;
  z-index:999;
}

/* ===== MODAL ===== */
#modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  display:none;
  align-items:center;
  justify-content:center;
}
#modalBox{
  background:#fff;
  padding:20px;
  border-radius:14px;
  width:85%;
  max-width:320px;
  text-align:center;
}
#modalBox button{width:100%;margin-top:10px}
</style>
</head>

<body>

<h2>Salon Chair System</h2>

<div class="card">
<b>Select Chair</b>
<div id="chairs"></div>
</div>

<div class="card">
<b>Select Services</b>
<div class="services">
  <button class="service" onclick="toggleService(this,'Haircut',150)">Haircut ₹150</button>
  <button class="service" onclick="toggleService(this,'Beard',80)">Beard ₹80</button>
  <button class="service" onclick="toggleService(this,'Facial',300)">Facial ₹300</button>
  <button class="service" onclick="toggleService(this,'Hair Color',100)">Hair Color ₹100</button>
</div>
</div>

<div class="card">
<b>Current Bill</b>
<p>Total: ₹ <span id="bill">0</span></p>
<button class="save" onclick="saveEntry()">Save Entry</button>
</div>

<div class="card total">
Today Total: ₹ <span id="todayTotal">0</span>
</div>

<div class="card">
<table>
<thead>
<tr><th>Date</th><th>Chair</th><th>Services</th><th>Amount</th></tr>
</thead>
<tbody id="records"></tbody>
</table>
</div>

<div class="card">
<button class="download" onclick="downloadReport()">Download Report</button>
</div>

<div class="card">
<button class="reset" onclick="openCloseDay()">Close Day</button>
</div>

<div id="toast"></div>

<div id="modal">
  <div id="modalBox">
    <p>Close today? Data will reset.</p>
    <button class="reset" onclick="closeDay()">Yes, Close Day</button>
    <button onclick="closeModal()">Cancel</button>
  </div>
</div>

<script>
/* ===== EXPIRY CONTROL ===== */
const PAID_TILL="2026-01-31";
if(new Date()>new Date(PAID_TILL)){
  document.body.innerHTML="<h2 style='text-align:center'>Service Disabled<br>Payment Pending</h2>";
}

/* ===== DATA ===== */
let selectedChair=null;
let services=[];
let bill=0;
let data=JSON.parse(localStorage.getItem("salonData"))||[];

/* ===== CHAIRS ===== */
const chairBox=document.getElementById("chairs");
for(let i=1;i<=5;i++){
  const b=document.createElement("button");
  b.innerText="Chair "+i;
  b.className="chair";
  b.onclick=()=>selectChair(i,b);
  chairBox.appendChild(b);
}
function selectChair(n,btn){
  selectedChair=n;
  document.querySelectorAll(".chair").forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");
  toast("Chair "+n+" selected");
}

/* ===== SERVICES TOGGLE ===== */
function toggleService(btn,name,price){
  if(!selectedChair){toast("Select chair first");return;}
  const i=services.findIndex(s=>s.name===name);
  if(i>-1){
    services.splice(i,1);
    bill-=price;
    btn.classList.remove("active");
  }else{
    services.push({name,price});
    bill+=price;
    btn.classList.add("active");
  }
  document.getElementById("bill").innerText=bill;
}

/* ===== SAVE ===== */
function saveEntry(){
  if(!selectedChair||services.length===0){
    toast("Select chair & service");
    return;
  }
  data.push({
    date:new Date().toLocaleDateString(),
    chair:selectedChair,
    services:services.map(s=>s.name).join("+"),
    amount:bill
  });
  localStorage.setItem("salonData",JSON.stringify(data));
  resetForm();
  render();
  toast("Entry saved");
}

/* ===== RESET FORM ===== */
function resetForm(){
  services=[];
  bill=0;
  document.getElementById("bill").innerText=0;
  document.querySelectorAll(".service").forEach(b=>b.classList.remove("active"));
}

/* ===== RENDER ===== */
function render(){
  let rows="";
  let total=0;
  data.forEach(r=>{
    rows+=`<tr><td>${r.date}</td><td>Chair ${r.chair}</td><td>${r.services}</td><td>₹${r.amount}</td></tr>`;
    total+=r.amount;
  });
  document.getElementById("records").innerHTML=rows;
  document.getElementById("todayTotal").innerText=total;
}
render();

/* ===== DOWNLOAD ===== */
function downloadReport(){
  if(data.length===0){toast("No data");return;}
  let csv="Date,Chair,Services,Amount\n";
  data.forEach(r=>{
    csv+=`${r.date},Chair ${r.chair},"${r.services}",${r.amount}\n`;
  });
  const a=document.createElement("a");
  a.href=URL.createObjectURL(new Blob([csv],{type:"text/csv"}));
  a.download="salon-report.csv";
  a.click();
}

/* ===== CLOSE DAY ===== */
function openCloseDay(){document.getElementById("modal").style.display="flex"}
function closeModal(){document.getElementById("modal").style.display="none"}
function closeDay(){
  localStorage.removeItem("salonData");
  data=[];
  render();
  closeModal();
  toast("Day closed");
}

/* ===== TOAST ===== */
function toast(msg){
  const t=document.getElementById("toast");
  t.innerText=msg;
  t.style.display="block";
  setTimeout(()=>t.style.display="none",2000);
}
</script>

</body>
</html>
