<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Salon Chair System</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" href="icon-512.png">
  <meta name="theme-color" content="#2563eb">

  <style>
    body {
      font-family: system-ui, Segoe UI, Roboto;
      background: #f2f4f8;
      padding: 12px;
    }
    h2 { text-align: center; }

    .card {
      background: #fff;
      padding: 14px;
      border-radius: 14px;
      margin-bottom: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,.08);
    }

    button {
      width: 100%;
      padding: 12px;
      margin: 6px 0;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      cursor: pointer;
    }

    .row { display: flex; gap: 8px; }
    .row button { flex: 1; }

    .chair { background: #2563eb; color: #fff; }
    .service { background: #e5e7eb; }
    .save { background: #16a34a; color: #fff; }
    .reset { background: #dc2626; color: #fff; }

    table { width: 100%; border-collapse: collapse; font-size: 14px; }
    th, td { border-bottom: 1px solid #ddd; padding: 6px; text-align: left; }

    .total {
      font-size: 20px;
      font-weight: bold;
      text-align: center;
    }
  </style>
</head>

<body>

<h2>Salon Chair System</h2>

<div class="card">
  <b>Select Chair</b>
  <div class="row">
    <button class="chair" onclick="selectChair(1)">Chair 1</button>
    <button class="chair" onclick="selectChair(2)">Chair 2</button>
    <button class="chair" onclick="selectChair(3)">Chair 3</button>
  </div>
  <div class="row">
    <button class="chair" onclick="selectChair(4)">Chair 4</button>
    <button class="chair" onclick="selectChair(5)">Chair 5</button>
  </div>
</div>

<div class="card">
  <b>Select Services</b>
  <button class="service" onclick="addService('Haircut',150)">Haircut ₹150</button>
  <button class="service" onclick="addService('Beard',80)">Beard ₹80</button>
  <button class="service" onclick="addService('Facial',300)">Facial ₹300</button>
  <button class="service" onclick="addService('Hair Color',100)">Hair Color ₹100</button>
</div>

<div class="card">
  <b>Current Bill</b>
  <div id="bill"></div>
  <p><b>Total:</b> ₹ <span id="billTotal">0</span></p>
  <button class="save" onclick="saveEntry()">Save Entry</button>
</div>

<div class="card">
  <div class="total">Today Total: ₹ <span id="todayTotal">0</span></div>
</div>

<div class="card">
  <b>Entries</b>
  <table>
    <thead>
      <tr><th>Chair</th><th>Services</th><th>Amount</th></tr>
    </thead>
    <tbody id="records"></tbody>
  </table>
</div>

<div class="card">
  <button class="save" onclick="downloadReport()">Download Report</button>
</div>

<div class="card">
  <button class="reset" onclick="closeDay()">Close Day</button>
</div>

<script>
let data = JSON.parse(localStorage.getItem("salonData")) || [];
let selectedChair = null;
let services = [];
let total = 0;

function selectChair(c) {
  selectedChair = c;
  alert("Chair " + c + " selected");
}

function addService(name, price) {
  if (!selectedChair) {
    alert("Select chair first");
    return;
  }
  services.push(name);
  total += price;
  document.getElementById("bill").innerText = services.join(" + ");
  document.getElementById("billTotal").innerText = total;
}

function saveEntry() {
  if (!selectedChair || services.length === 0) {
    alert("Select chair & service");
    return;
  }
  data.push({ chair: selectedChair, services, amount: total });
  localStorage.setItem("salonData", JSON.stringify(data));
  services = [];
  total = 0;
  document.getElementById("bill").innerText = "";
  document.getElementById("billTotal").innerText = 0;
  render();
}

function render() {
  let rows = "";
  let sum = 0;
  data.forEach(r => {
    rows += `<tr><td>${r.chair}</td><td>${r.services.join("+")}</td><td>₹${r.amount}</td></tr>`;
    sum += r.amount;
  });
  document.getElementById("records").innerHTML = rows;
  document.getElementById("todayTotal").innerText = sum;
}
render();

function closeDay() {
  if (confirm("Close today? Data will reset")) {
    localStorage.removeItem("salonData");
    data = [];
    render();
  }
}

function downloadReport() {
  if (data.length === 0) {
    alert("No data to download");
    return;
  }
  let csv = "Chair,Services,Amount\n";
  data.forEach(r => {
    csv += `${r.chair},"${r.services.join("+")}",${r.amount}\n`;
  });
  let blob = new Blob([csv], { type: "text/csv" });
  let a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "salon-report.csv";
  a.click();
}
</script>

</body>
</html>
