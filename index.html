<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Salon Chair System</title>

<style>
body{
  font-family: system-ui, Segoe UI, Roboto;
  background:#f2f4f8;
  padding:14px;
  margin:0;
}

h2{
  text-align:center;
  margin-bottom:14px;
}

/* ===== CARD ===== */
.card{
  background:#fff;
  padding:16px;
  border-radius:16px;
  margin-bottom:14px;
  box-shadow:0 8px 20px rgba(0,0,0,.08);
}

/* ===== ROW ===== */
.row{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}

/* ===== BUTTON ===== */
button{
  padding:16px;
  font-size:16px;
  border-radius:14px;
  border:none;
  cursor:pointer;
}

/* ===== CHAIRS ===== */
.chair{
  background:#2563eb;
  color:#fff;
  flex:1 1 100%;
}

.chair.active{
  background:#16a34a;
}

/* ===== SERVICES ===== */
.service{
  background:#e5e7eb;
  flex:1 1 48%;
}

/* ===== ACTION BUTTONS ===== */
.save{
  background:#16a34a;
  color:#fff;
  width:100%;
}

.reset{
  background:#dc2626;
  color:#fff;
  width:100%;
}

.download{
  background:#15803d;
  color:#fff;
  width:100%;
}

/* ===== TOTAL ===== */
.total{
  font-size:22px;
  font-weight:bold;
  text-align:center;
}

/* ===== TABLE FIX ===== */
.table-wrap{
  overflow-x:auto;
}

table{
  width:100%;
  min-width:650px;
  border-collapse:collapse;
  font-size:14px;
}

th,td{
  padding:10px;
  border-bottom:1px solid #ddd;
  text-align:left;
  word-break:break-word;
}

/* ===== TOAST ===== */
#toast{
  position:fixed;
  bottom:30px;
  left:50%;
  transform:translateX(-50%);
  background:#111827;
  color:#fff;
  padding:14px 20px;
  border-radius:14px;
  display:none;
  z-index:1000;
}

/* ===== MODAL ===== */
#modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.55);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:1000;
}

#modalBox{
  background:#fff;
  padding:20px;
  border-radius:16px;
  width:85%;
  max-width:320px;
  text-align:center;
}
#modalBox button{
  width:100%;
  margin-top:10px;
}
</style>
</head>

<body>

<h2>Salon Chair System</h2>

<div class="card">
<b>Select Chair</b>
<div class="row" id="chairs"></div>
</div>

<div class="card">
<b>Select Services</b>
<div class="row">
  <button class="service" onclick="addService('Haircut',150)">Haircut ₹150</button>
  <button class="service" onclick="addService('Beard',80)">Beard ₹80</button>
  <button class="service" onclick="addService('Facial',300)">Facial ₹300</button>
  <button class="service" onclick="addService('Hair Color',100)">Hair Color ₹100</button>
</div>
</div>

<div class="card">
<b>Current Bill</b>
<p>Total: ₹ <span id="billTotal">0</span></p>
<button class="save" onclick="saveEntry()">Save Entry</button>
</div>

<div class="card total">
Today Total: ₹ <span id="todayTotal">0</span>
</div>

<div class="card table-wrap">
<b>Entries</b>
<table>
<thead>
<tr>
  <th>Date</th>
  <th>Chair</th>
  <th>Services</th>
  <th>Amount</th>
</tr>
</thead>
<tbody id="records"></tbody>
</table>
</div>

<div class="card">
<button class="download" onclick="downloadReport()">Download Report</button>
</div>

<div class="card">
<button class="reset" onclick="openCloseDay()">Close Day</button>
</div>

<!-- TOAST -->
<div id="toast"></div>

<!-- MODAL -->
<div id="modal">
  <div id="modalBox">
    <p>Close today? Data will reset.</p>
    <button class="reset" onclick="closeDay()">Yes, Close Day</button>
    <button onclick="closeModal()">Cancel</button>
  </div>
</div>

<script>
/* ===== EXPIRY CONTROL ===== */
const PAID_TILL = "2026-01-31";
if(new Date() > new Date(PAID_TILL)){
  document.body.innerHTML =
    "<h2 style='text-align:center'>Service Disabled<br>Payment Pending</h2>";
}

/* ===== DATA ===== */
let selectedChair = null;
let services = [];
let total = 0;
let data = JSON.parse(localStorage.getItem("salonData")) || [];

/* ===== CHAIRS INIT ===== */
const chairBox = document.getElementById("chairs");
for(let i=1;i<=5;i++){
  let b = document.createElement("button");
  b.innerText = "Chair " + i;
  b.className = "chair";
  b.onclick = () => selectChair(i, b);
  chairBox.appendChild(b);
}

function selectChair(n, btn){
  selectedChair = n;
  document.querySelectorAll(".chair").forEach(b => b.classList.remove("active"));
  btn.classList.add("active");
  toast("Chair " + n + " selected");
}

/* ===== SERVICES ===== */
function addService(name, price){
  if(!selectedChair){
    toast("Select chair first");
    return;
  }
  services.push(name);
  total += price;
  document.getElementById("billTotal").innerText = total;
}

/* ===== SAVE ENTRY ===== */
function saveEntry(){
  if(!selectedChair || services.length === 0){
    toast("Select chair & service");
    return;
  }
  data.push({
    date: new Date().toLocaleDateString(),
    chair: selectedChair,
    services: [...services],
    amount: total
  });

  localStorage.setItem("salonData", JSON.stringify(data));
  services = [];
  total = 0;
  document.getElementById("billTotal").innerText = 0;
  render();
  toast("Entry saved");
}

/* ===== RENDER ===== */
function render(){
  let tbody = document.getElementById("records");
  tbody.innerHTML = "";
  let sum = 0;

  data.forEach(r => {
    sum += r.amount;
    tbody.innerHTML += `
      <tr>
        <td>${r.date}</td>
        <td>Chair ${r.chair}</td>
        <td>${r.services.join(" + ")}</td>
        <td>₹${r.amount}</td>
      </tr>`;
  });

  document.getElementById("todayTotal").innerText = sum;
}
render();

/* ===== DOWNLOAD CSV ===== */
function downloadReport(){
  if(data.length === 0){
    toast("No data to download");
    return;
  }
  let csv = "Date,Chair,Services,Amount\n";
  data.forEach(r => {
    csv += `${r.date},Chair ${r.chair},"${r.services.join(" + ")}",${r.amount}\n`;
  });
  let blob = new Blob([csv], {type:"text/csv"});
  let a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "salon-report.csv";
  a.click();
}

/* ===== CLOSE DAY ===== */
function openCloseDay(){
  document.getElementById("modal").style.display="flex";
}
function closeModal(){
  document.getElementById("modal").style.display="none";
}
function closeDay(){
  localStorage.removeItem("salonData");
  data = [];
  render();
  closeModal();
  toast("Day closed");
}

/* ===== TOAST ===== */
function toast(msg){
  let t = document.getElementById("toast");
  t.innerText = msg;
  t.style.display = "block";
  setTimeout(() => t.style.display = "none", 2000);
}
</script>

</body>
</html>
